---
title: "Projet IF36"
author: "Koehler Theo, Delhomme Louis, Chivas Matthieu, Rubagotti Lucas"
date: '2024-05-05'
output:
  html_document: default
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
options(repos = c(CRAN = "https://cran.rstudio.com/")) # Définition du miroir CRAN

#installations
install.packages("readr")
install.packages("ggplot2")
install.packages("dplyr")
install.packages("xlsx")
```

```{r ImportationMat, include=FALSE}
library(ggplot2)
library(dplyr)
library(readr)

tableMat <- read_csv("./data/student-mat.csv")
tableMat$MoyenneNote <- rowMeans(tableMat[,c("G1","G2","G3")])
```


```{r ImportationPortugais, include=FALSE}
tablePor <- read_csv("./data/student-por.csv")
tablePor$MoyenneNote <- rowMeans(tablePor[,c("G1","G2","G3")])
```

Dans un premier temps, nous devons nous poser la question de comment allons-nous étudier nos données. En effet, on à  notre dispotition deux datasets : un sur les élèves suivant le cours de mathématiques (395) et l'autre de portugais (649). Or il est important de noter que la plupart des étudiants de mathématiques suivent également le cours de portugais (382 / 395).

De la sorte, si l'on essaie de joindre les deux datasets, nous auront des doublons, et même si on sait les identifier, il n'est pas pertinent des les fusionner pour les rendre unique. En effet, cela signifierait que l'on doive également fusionner des résultats scolaires de mathématiques et de portugais en une moyenne des deux, alors que les moyennes et répartitions des notes diffèrent entre dans ces deux domaines. Cela ne serait pas être pertinant.

Ainsi, en prenant en compte cette problématique, il nous est offert 3 chemins pour étudier notre dataset :

1.  N'étudier que les élèves de mathématiques : des résultats scolaires issus d'une science exacte et évitant les doublons d'étudiants

2.  N'étudier que les élèves de portugais : des résultats scolaires qui peuvent différer de ceux d'une science exacte et évitant les doublons

3.  Etudier la jointure des étudiants de mathématiques et de portugais : des résultats scolaires mixtes et moins pertinents et considérant les doublons comme deux étudiants à  part entière

Il peut être intéressant de répondre aux questions que l'on se pose sous différents angles et de comparer les résultats en fonction de ceux-ci. Nous allons donc considérer ces trois possibilités et les exploiter dans les réponses à  nos interrogations.

Pour ceci, on a donc besoin du troisième dataset qui joint les deux autres, on le nommera all_students.

```{r,merge datasets, include=FALSE}
all_students <- full_join(tableMat, 
                   tablePor,
                   by= c("school","sex","age","address","famsize","Pstatus","Medu","Fedu","Mjob","Fjob","reason","guardian","traveltime","studytime","failures","schoolsup","famsup","paid","activities","nursery","higher","internet","romantic","famrel","freetime","goout","Dalc","Walc","health","absences","G1","G2","G3"))
all_students$MoyenneNote <- rowMeans(all_students[,c("G1","G2","G3")])
all_students <- mutate(all_students, generalsup=ifelse(grepl("yes",schoolsup) | grepl("yes","famsup"),"yes",famsup))
```



## Question 1: Le fait de sortir souvent avec des amis entraîne-t-il nécessairement une plus grande consommation d'alcool ?


Pour continuer notre étude exploratoire des habitudes de vie des étudiants nous souhaitions analyser une possible influence des sorties entre amis sur la consommation d'alcool.
Les jeunes adaptent-ils leur consommation d'alcool en fonction de leurs sorties? Quelle forme prend cette consommation d'alcool sur une semaine?
Nous aurions tendance à penser que les personnes voyant souvent leurs amis en dehors des cours seraient plus fréquemment exposés à l'alcool lors de soirées par exemple. De ce fait, nous pourrions nous attendre à constater une forte consommation d'alcool chez les individus sortant beaucoup.
Une consommation d'alcool plus importante le week-end qu'en semaine chez les étudiants serait également en accord avec la pensée commune.

Nous allons donc réaliser une analyse exploratoire de notre dataset pour comparer nos pensées avec la réalité des individus étudiés.

Les donnéees qui m'interessent pour répondre à  cette question sont :

- **goout** : fréquence de sorties entre amis (numérique : de 1  très faible à  5  très élevé)
- **Dalc** : consommation d'alcool en semaine (numérique : de 1  très faible à  5  très élevé)
- **Walc** : consommation d'alcool le week-end (numérique : de 1  très faible à  5  très élevé)
- **age** : age des individus (numérique)
- **sex** : sexe des individus (nominal : F ou M)


```{r FiltrageMat, include=FALSE}
#Je n'ai maintenant que besoin de goout, Dalc, Walc, age et sex donc je garde les colonnes qui m'interesse pour économiser les traitements
tableMat1 <- tableMat[,c("goout","Dalc","Walc","age","sex")]
head(tableMat1)


#Personnes sortant fréquemment
tableMat_filtered <- tableMat1 %>% filter(goout > 4)
```


```{r diagrammeRépartitionDalcWalc, fig.align='center', echo=FALSE}

library(ggplot2)
library(dplyr)

# Data preparation pour les personnes sortant beaucoup
freq_dalc <- table(tableMat_filtered$Dalc)
total <- sum(freq_dalc)
freq_dalc <- (freq_dalc / total) * 100

freq_walc <- table(tableMat_filtered$Walc)
total_walc <- sum(freq_walc)
freq_walc <- (freq_walc / total_walc) * 100

notes <- c(1, 2, 3, 4, 5)
df_dalc <- data.frame(notes = factor(notes), frequences = as.numeric(freq_dalc))
df_walc <- data.frame(notes = factor(notes), frequences = as.numeric(freq_walc))

# Data preparation pour les personnes sortant peu
tableMat_filtered_inf <- tableMat %>% filter(goout < 4)

freq_dalc_inf <- table(tableMat_filtered_inf$Dalc)
total_inf <- sum(freq_dalc_inf)
freq_dalc_inf <- (freq_dalc_inf / total_inf) * 100

freq_walc_inf <- table(tableMat_filtered_inf$Walc)
total_walc_inf <- sum(freq_walc_inf)
freq_walc_inf <- (freq_walc_inf / total_walc_inf) * 100

df_dalc_inf <- data.frame(notes = factor(notes), frequences = as.numeric(freq_dalc_inf))
df_walc_inf <- data.frame(notes = factor(notes), frequences = as.numeric(freq_walc_inf))

# Combinaison des 4 graphiques dans un seul pour plus de visibilité
df_dalc$type <- "Consommation en semaine - Sortant beaucoup"
df_walc$type <- "Consommation le week-end - Sortant beaucoup"
df_dalc_inf$type <- "Consommation en semaine - Sortant peu"
df_walc_inf$type <- "Consommation le week-end  - Sortant peu"

combined_df <- bind_rows(df_dalc, df_walc, df_dalc_inf, df_walc_inf)

str(combined_df)
head(combined_df)

# Création du graphique général
ggplot(combined_df, aes(x = "", y = frequences, fill = notes, label = paste0(round(frequences, 1), "%"))) +
  geom_bar(stat = "identity") +
  geom_text(position = position_stack(vjust = 0.5)) + # Add centered percentages
  coord_flip() +
  labs(x = "", y = "Proportions") +
  theme_minimal() +
  scale_fill_brewer(palette = "YlOrRd") +
  facet_wrap(~ type, scales = "free_y") + # Facet by type
  theme(plot.title = element_text(hjust = 0.5))

```

Le premier objectif de notre étude est de visualiser la répartition des personnes sortant souvent entre amis en fonction de leur consommation d'alcool.

Nous avons donc, d'une part, uniquement gardé les individus ayant évalué leur fréquence de sortie à 5 sur 5.
D'autre part, nous avons gardé ceux s'étant attribué une note de 1, 2 ou 3.
Ces individus ont également évalué leur consommation d'alcool en semaine et le week-end.

Après avoir réalisé ces visualisations plusieurs choses sont constatables:

En semaine, la majorité (71.7%) des étudiants sortant souvent entre amis ne boit que très peu d'alcool tandisqu'un quart d'entre eux consomme fréquemment ou très fréquemment de l'alcool.
Le week-end, la tendance s'inverse. En effet, 54.7% consomment fréquemment ou très fréquemment de l'alcool et seulement 28.3% que rarement ou très rarement.
Nous constatons qu'un quart des étudiants sortant souvent consomment occasionellement de l'alcool que ce soit en semaine ou le week-end.

Nous savons que les étudiant organisent souvent des sorties entre eux le week-end et moins en semaine en raison de leurs cours. De ce fait, le week-end devient le moment de la semaine où ils peuvent s'amuser sans avoir peur des conséquences et donc consommer plus d'alcool.

D'autre part, nous constatons clairement que les étudiants sortant rarement entre amis consomment beaucoup moins d'alcool que ceux sortant souvent et ce, en semaine mais aussi le week-end.

Il semble donc clair que le fait de sortir souvent avec des amis entraînerait une plus grande consommation d'alcool.

Pour approfondir encore notre étude nous pouvons tenter d'observer une divergence ou une similarité dans la consomamtion d'alcool chez les étudiants sortant souvent en fonction du sexe.

### Analyse de la consommation d'alcool chez les étudiants sortant fréquemment en fonction de leur sexe

```{r diagrammeSexe, fig.align='center', echo=FALSE}

summary_data <- tableMat_filtered %>%
  group_by(Walc, sex) %>%
  summarise(count = n()) %>%
  ungroup()

# Créer le graphique à barres empilées
ggplot(summary_data, aes(x = factor(Walc), y = count, fill = sex)) +
  geom_bar(stat = "identity", position = "stack") +
  labs(x = "Consommation d'alcool en semaine (Walc)", y = "Nombre d'individus", title = "Consommation d'alcool le week-end chez les personnes sortant souvent par sexe") +
  scale_fill_manual(values = c("yellow3", "mediumpurple"), labels = c("Femme", "Homme")) +  # Définir les couleurs et les labels pour le sexe avec l'ordre correct
  theme_minimal() 


summary_data <- tableMat_filtered %>%
  group_by(Dalc, sex) %>%
  summarise(count = n()) %>%
  ungroup()

# Créer le graphique à barres empilées
ggplot(summary_data, aes(x = factor(Dalc), y = count, fill = sex)) +
  geom_bar(stat = "identity", position = "stack") +
  labs(x = "Consommation d'alcool en semaine (Walc)", y = "Nombre d'individus", title = "Consommation d'alcool la semaine chez les personnes sortant souvent par sexe") +
  scale_fill_manual(values = c("yellow3", "mediumpurple"), labels = c("Femme", "Homme")) +  # Définir les couleurs et les labels pour le sexe avec l'ordre correct
  theme_minimal() 

```

Analysons les visualisations obtenues.

En semaine, les étudiants sortant très fréquemment et consommant très rarement de l'alcool sont en majorité des femmes. La quasi totalité des femmes sortant fréquemment entre amis boivent très rarement. Les hommes ont quant à eux une consommation d'alcool plus répartie et uniforme. En effet, il y autant d'hommes qui en boivent très rarement que très fréquemment.

Le weekend, les hommes et les femmes consomment de l'alcool de manière beaucoup plus fréquente comme montré précédemment. 

Les femmes qui sortent beaucoup entre amis ont donc tendances à boire très peu en semaine mais beaucoup plus fréquemment le week-end.
Les hommes quant à eux ont en semaine une consomamtion d'alcool variant entre les individus mais s'accordent globalement le week-end pour boire très fréquemment.

Finalement, il existe une différence notable de comportement face à l'alcool entre les hommes et les femmes en semaine. Cependant, le week-end, les deux sexes ont tendance à consommer de manière identique.

Il est également possible de réaliser cette même étude en se penchant sur l'âge des indivuds plutôt que sur leur sexe.

### Analyse de la consommation d'alcool chez les étudiants sortant fréquemment en fonction de leur âge



```{r diagrammeAge, fig.align='center', echo=FALSE}

summary_data <- tableMat_filtered %>%
  group_by(Walc, age) %>%
  summarise(count = n()) %>%
  ungroup()

# Créer le graphique à barres empilées
ggplot(summary_data, aes(x = factor(Walc), y = count, fill = factor(age))) +
  geom_bar(stat = "identity", position = "stack") +
  scale_fill_manual(values = c("#FF0000","#FF4500", "#FF6347", "#99FFFF", "#00ccFF", "#0000FF"),
                    labels = c("15 ans", "16 ans", "17 ans", "18 ans", "19 ans", "22 ans")) +
  labs(x = "Consommation d'alcool en semaine (Walc)", y = "Nombre d'individus", title = "Consommation d'alcool la semaine chez les personnes sortant souvent par sexe") +
  theme_minimal()


summary_data <- tableMat_filtered %>%
  group_by(Dalc, age) %>%
  summarise(count = n()) %>%
  ungroup()

# Créer le graphique à barres empilées
ggplot(summary_data, aes(x = factor(Dalc), y = count, fill = factor(age))) +
  geom_bar(stat = "identity", position = "stack") +
  scale_fill_manual(values = c("#FF0000","#FF4500", "#FF6347", "#99FFFF", "#00ccFF", "#0000FF"),
                    labels = c("15 ans", "16 ans", "17 ans", "18 ans", "19 ans", "22 ans")) +
  labs(x = "Consommation d'alcool en semaine (Walc)", y = "Nombre d'individus", title = "Consommation d'alcool la semaine chez les personnes sortant souvent par sexe") +
  theme_minimal()

```

Grâce aux visualisations réalisées nous pouvons observer plusieurs phénomènes.

En semaine, la quasi totalité des étudiants majeurs sortant souvent entre amis boivent assez peu fréquemment de l'alcool. Cependant, ils ont tendance à tous boire plus souvent le week-end. Cette différence est uniquement dû aux étudiants ayant 18 ans car ceux ayant 19 ou 22 ans ne change pas leur fréquence de consommation en fonction du moment de la semaine.

Les étudiants mineurs sont intéressants à étudier. En effet, malgré qu'ils soient mineurs et n'ont donc pas le dorit légal de boire de l'alcool, une partie non négligeable d'entre eux admet en consommer de manière plus ou moins fréquente. En semaine, la grande majorité des étudiants admettant consommer fréquemment de l'alcool est constituée de mineurs. Le week-end ils sotn encore plus à en boire fréquemment.

Cependant, le weekend, les personnes ne buvant pas d'alcool sont uniquement des mineurs.

On constate donc une différence de comportement face à l'alcool en fonction de l'âge des individus sortant fréquemment entre amis. Cela pourrait être causé par le fait que les mineurs sont possiblement plus influençables et ont tendance à immiter les plus grands, entrainant ainsi une consommation d'alcool toujours plus précoce. 





## Question2 - les sportifs ont-ils de meilleurs résultats scolaires que les autres ?

Il nous est souvent raconté que faire du sport permet un meilleur apprentissage, une meilleure concentration et un meilleur développement. Suivant cette logique, il nous est expliqué que par extension, le sport permet d'obtenir de meilleurs résultats scolaires. Mais est-ce la vérité ?

Nous allons donc essayer de résoudre cette énigme en nous posant la question suivante : les sportifs ont-ils de meilleurs résultats scolaires que les autres ?

Pour répondre à  cette question il faut donc tout d'abord identifier ce qu'est un sportif. Il nous a semblé concret d'identifier un sportif comme ayant un niveau de santé supérieur ou égal à  3/5 et participant à  des activités extra-scolaires.

```{r Question 2 : Identifier les sportifs, fig.align='center', echo=FALSE}
#Question 1 :
#Faire du sport permet-il vraiment dâ€™avoir de meilleurs résultats scolaires ?
all_students2 <- all_students
tablePor2 <- tablePor
tableMat2 <- tableMat

# Créer la variable sportif dans les 3 datasets
all_students2$sportif <- ifelse(all_students2$health >= 3 & all_students2$activities == "yes", TRUE, FALSE)
tablePor2$sportif <- ifelse(tablePor2$health >= 3 & tablePor2$activities == "yes", TRUE, FALSE)
tableMat2$sportif <- ifelse(tableMat2$health >= 3 & tableMat2$activities == "yes", TRUE, FALSE)
```

Egalement, afin de comparer les résultats scolaires des étudiants, il nous faut une variable unique indiquant ces résultats. On a donc simplement créé la variable "mean_results", étant la moyenne des résultats scolaires des étudiants sur les 3 examens du semestre. Ne connaissant pas le poids de chacun des examens, nous avons posé une pondération linéaire : chacun des examens compte pour autant.

```{r Question 2 : Voir les résultats moyens de chaque étudiants, fig.align='center', echo=FALSE}
#Question 1 :
#Faire du sport permet-il vraiment dâ€™avoir de meilleurs résultats scolaires ?

# Calculer la moyenne des variables G1, G2 et G3 dans les 3 datasets
mean_results_global <- rowMeans(all_students[, c("G1", "G2", "G3")])
mean_results_mat <- rowMeans(tableMat2[, c("G1", "G2", "G3")])
mean_results_por <- rowMeans(tablePor2[, c("G1", "G2", "G3")])
```

Nous devrions maintenant avoir les clés en main pour essayer de répondre à  notre interrogation.

Dans un premier temps, nous allons essayer d'étudier la question en regardant le dataset qui joint les étudiants de portuguais et de mathématiques : all_students.

On doit donc essayer de mettre en évidence les résultats scolaires en fonction de deux facteurs : la santé et la sportivité.

Tout d'abord, il nous a semblé être le plus représentatif de poser les résultats scolaires en ordonnée et la santé en abscisse. On aura donc 5 colonnes indiquant les résultats scolaires en fonction de la santé, qui seront facilement comparables.

Ensuite, pour ce qui est de la sportivité, représentons simplement d'une autre couleur les étudiants considérés comme"sportifs".

Enfin, traà§ons la moyenne des résultats scolaires pour "sportifs" et "non-sportifs" afin de voir s'il y a en effet une différence de niveau.

```{r Question 2 : Visu 1 joint, fig.align='center', echo=FALSE}
#Question 1 :
#Faire du sport permet-il vraiment dâ€™avoir de meilleurs résultats scolaires ?

# Visualisation des résultats scolaires moyens en fonction de la santé et de la sportivité dans la jointure des deux classes de portugais et de mathématiques
ggplot(data = all_students2, aes(x = health, y = mean_results_global)) +
  geom_point(aes(color = sportif)) +
  geom_smooth(method = "lm", se = FALSE, aes(color = sportif)) + 
  labs(x = "Niveau de santé sur 5", y = "Résultats moyens") +
  ggtitle("Résultats scolaires moyens en fonction de la santé et de la sportivité (GLOBAL)")
```

On remarque ainsi que si l'on regarde tous les étudiants, la santé seule ne semble pas jouer sur les résultats scolaires : les résultats moyens sont les mêmes quelque soit le niveau de santé des étudiants (si on combine sportifs + non-sportifs). La seule différence que l'on observe est celle entre les étudiants en bonne santé sportifs et les étudiants en bonne santé non-sportifs. Néanmoins même si cette différence est bien présente, elle n'est pas non plus très significative.

On n'observe donc pas de résultats flagrants. On peut remettre aussi en question nos résultats puisque nous comparons les résultats scolaires globaux en regardant du même oeil des résultats de mathématiques que ceux de portugais.

Il semble donc nécessaire de regarder ce que l'on pourrait obtenir en ne regardant que individuellement les classes de mathématiques et de portugais et en gardant le même modèle de visualisation.

```{r Question 2 : Visu 2 por, fig.align='center', echo=FALSE}
#Question 1 :
#Faire du sport permet-il vraiment dâ€™avoir de meilleurs résultats scolaires ?

# Visualisation des résultats scolaires moyens en fonction de la santé et de la sportivité dans la classe de portugais
ggplot(data = tablePor2, aes(x = health, y = mean_results_por)) +
  geom_point(aes(color = sportif)) +
  geom_smooth(method = "lm", se = FALSE, aes(color = sportif)) + 
  labs(x = "Niveau de santé sur 5", y = "Résultats moyens") +
  ggtitle("Résultats scolaires moyens en fonction de la santé et de la sportivité (Portugais)")
```

```{r Question 2 : Visu 3 mat, fig.align='center', echo=FALSE}
#Question 1 :
#Faire du sport permet-il vraiment dâ€™avoir de meilleurs résultats scolaires ?

# Visualisation des résultats scolaires moyens en fonction de la santé et de la sportivité dans la classe de mathématiques
ggplot(data = tableMat2, aes(x = health, y = mean_results_mat)) +
  geom_point(aes(color = sportif)) +
  geom_smooth(method = "lm", se = FALSE, aes(color = sportif)) + 
  labs(x = "Niveau de santé sur 5", y = "Résultats moyens") +
  ggtitle("Résultats scolaires moyens en fonction de la santé et de la sportivité (Maths)")
```

En analysant les résultats issus des classes de portugais de mathématiques nous retombons sur des conclusions plutà´t similaires : il semblerait que plus les étudiants sont en bonne santé, plus le fait dêtre sportif semble améliorer les résultats scolaires.

En revanche, cette amélioration peut-être remise en cause. Elle n'est que minime, et les résultats moyens des sportifs restent similaires à  ceux obtenus par les étudiants en mauvaise santé. Cela montre-t-il que le sport n'apporte rien ?

Mais plus précisément, le problème ne vient-il pas simplement de notre définition de ce qu'est un sportif ? Notre approche de cette définition est finalement simpliste : sportif = santé + activités, mais un étudiant en bonne santé pratiquant des activités extra-scolaires peut très bien ne pas être sportif du tout. Il peut être passioné par l'art et de ce fait pratiquer des activités au delà  de ses études.

Il faut donc essayer de trouver nouvel un angle d'approche à  notre étude. Simplifions la problématique, évitons des erreurs d'interprétations et regardons directement si les étudiants pratiquent des activités extra-scolaires, et si l'on peut lier ceci au reste des données.

Nous allons à  nouveau étudier la classe de portugais avec le même modèle puisque c'est celle qui nous donné les meilleurs résultats précedemment. Changeons simplement la variable "sportif" en la variable "goes_out" signifiant si oui ou non un étudiant pratique des activités extra-scolaires.

```{r Question 2 : Visu 3 por - activities, fig.align='center', echo=FALSE}
#Question 1 :
#Faire du sport permet-il vraiment dâ€™avoir de meilleurs résultats scolaires ?


# Identifier les étudiants qui pratiquent des activités extra-scolaires dans une nouvelle variable pour plus de lisibilité
tablePor2$goes_out <- ifelse(tablePor2$activities == "yes", TRUE, FALSE)

# Visualisation des résultats scolaires moyens en fonction de la santé et des activités dans la classe de portugais
ggplot(data = tablePor2, aes(x = health, y = mean_results_por)) +
  geom_point(aes(color = goes_out)) +
  geom_smooth(method = "lm", se = FALSE, aes(color = goes_out)) + 
  labs(x = "Niveau de santé sur 5", y = "Résultats moyens") +
  ggtitle("Résultats scolaires moyens en fonction de la santé et des activités (Portugais)")
```

Ainsi, avec cette approche, nous observons tout de suite des résultats différents. On remarque aisément que plus un étudiant a un bon niveau de santé, plus il lui sera bénéfique par rapport aux autres de faire des activités extra-scolaires.

En revanche, les bénéfices ne sont pas vraiment existants. Le niveau n'évolue pas positivement, il se maintient juste. La pratique des activités extra-scolaires semble seulement permettre de maintenir un niveau scolaire équivalent quelque soit la santé, là  oà¹ la non-pratique semble le faire régresser. On peut tout de même dire qu'il faut donc pratiquer des activités extra-scolaires pour en moyenne avoir de meilleurs résultats que les autres.

[Hypothèses]

Pourquoi la différence activités / pas d'activités s'accentue avec la santé ?\
Cela pourrait s'expliquer par le fait qu'utiliser son énergie dans des activités extra-scolaires peut permettre de majoritairement s'épanouir quand on est en bonne santé et peut-être de plus se fatiguer lorsque l'on est en mauvaise santé.

Pourquoi n'a-t-on pas des résultats si peu convaincants ?

Peut être que dans notre jeu de données, ceux pratiquant des activités extra-scolaires n'ont pas été tant meilleurs que les autres et qu'il nous faudrait plus de données pour avoir de meilleures résultats.

En conclusion, avec notre jeu de données, il n'est pas vraiment possible de répondre à  la question "Faire du sport permet-il vraiment dâ€™avoir de meilleurs résultats scolaires ?". En revanche, essayer de répondre à  cette question a permis de mettre en évidence des différences scolaires en fonctions des niveaux de santé et de la pratique d'activités extra-scolaires. Cela a finalement permis de répondre à  une question tout autre qui pourrait être "Est-il bon pour les études de pratiquer des activités extra-scolaires quelque soit sa santé ?". Question à  laquelle la réponse est oui, mais il faut adapter ses activités à  son niveau de santé afin de maximiser ses résultats scolaires.










## Question 3: Existe-t-il une corrélation entre les les étudiants considérés comme geek et leurs notes en mathématiques?

### Partie exploratoire

Nous avons ce cliché en tête qui dit que les geeks sont des personnes qui ont de bonnes notes en mathématiques. Nous allons essayer de voir si cela est vrai en analysant un dataset d'étudiants.

Tout d'abord nous allons définir ce qu'est un geek. Pour cela nous allons considérer un étudiant comme geek si :
<br>- **activities** : activités extra-scolaires sont égale à  "no" 
<br>- **internet** : accès à  Internet à  domicile est égale à  "yes"
<br>- **goout** : sorties avec des amis est inférieur à  2 
Ces critères de sélection sont parfaitement arbitraires et ne représentent en aucun cas la réalité.

Ensuite nous allons regarder les notes en mathématiques des élèves et nous verrons si corrélation il existe.

Les notes de maths sont les variables : 
<br>- **G1** : note du premier trimestre
<br>- **G2** : note du deuxième trimestre
<br>- **G3** : note du troisième trimestre


```{r distributionBoxplot, fig.align='center', echo=FALSE}
# Définir les critères pour considérer un étudiant comme geek
data <- tableMat %>%
  mutate(geek = ifelse(activities == "no" & 
                        internet == "yes" & 
                        goout < 2, "Geek", "Non-Geek"))

# Calcule de la moyenne des notes en mathématiques sur les trois semestres
moyenneNote <- rowMeans(data[,c("G1","G2","G3")])


# Créer un graphique pour comparer les notes 
ggplot(data, aes(x = geek, y = moyenneNote)) +
  geom_boxplot(fill = "lightyellow") +
  labs(title = "Comparaison des moyennes en mathématiques entre geeks et non-geeks",
       x = "Statut",
       y = "moyenne en mathématiques") +
  theme_minimal()
```
<br>Dans ce premier graphique on utilise un geom boxplot car il est utile pour se rendre compte de la distribution des moyennes et de la médiane dans chaque catégorie. On remarque que les geeks ont une moyenne légèrement plus élevée mais cela n'est pas significatif et peut-être dà» à  d'autre facteurs. Il y a aussi une valeur très en dessous des autres, cela peut être une valeur abérrante.


```{r distributionViolin, fig.align='center', echo=FALSE}
# Créer un graphique pour comparer les notes 
ggplot(data, aes(x = geek, y = moyenneNote)) +
  geom_violin(fill = "lightgreen") +
  stat_summary(fun = median, geom = "errorbar", aes(ymin = after_stat(y), ymax = after_stat(y), color = "Médiane"),     width = 0.5, linetype = "dashed") + 
  scale_color_manual(values = "red", name = "Légende", labels = "Médiane") +
  labs(title = "Comparaison des moyennes en mathématiques entre geeks et non-geeks",
       x = "Statut",
       y = "moyenne en mathématiques") +
  theme_minimal()
```
<br>Ce deuxième graphique est identique au précédent à  la différence qu'il est sous forme violon. Cela permet une meilleure estimation de la densité de moyenne pour une moyenne donnée. On remarque que pour les geeks la densité est la plus élevée autour de la médiane contrairement aux autres. On peut aussi remarquer anomalie pour les moyennes autour de 5. Cela montre une séparation en deux groupes parmi les geeks.

```{r repartitionScatterplot, fig.align='center', echo=FALSE}
# Créer un nuage de points pour visualiser les notes en mathématiques entre les geeks et les non-geeks
ggplot(data, aes(x = geek, y = moyenneNote, color = geek)) +
  geom_point() +
  labs(title = "Notes en mathématiques entre geeks et non-geeks",
       x = "étudiants") +
  scale_color_manual(values = c("Geek" = "blue", "Non-Geek" = "red")) +
  theme_minimal()
```
<br>Sur ce troisième graphique, on a décidé d'afficher chaque moyenne de manière individuelle pour pouvoir mieux se rendre compte de la répartition des notes. On remarque instantanément qu'il y a une grande différence d'échantillon parmi les deux catégories traitées. C'est est une première limite liée à  cette analyse de données.
Nous pouvons quand même dire que les données affichées sont cohérentes avec les deux premiers graphiques. On distingue bien deux groupes ainsi que la médiane.

```{r quantitePersonnes, fig.align='center', include=FALSE}
count_data <- data %>%
  count(geek)

ggplot(count_data, aes(x = geek, y = n)) +
  geom_bar(stat = "identity", fill = "lightblue") +
  geom_text(aes(label = n), vjust = -0.5, size = 4, color = "black") +
  labs(title = "Nombre de personnes dans chaque catégorie",
       x = "Catégorie",
       y = "Nombre de personnes") +
  theme_minimal()
```
<br>Sur ce dernier graphique, on a décidé de compter le nombre de personnes dans chaque catégorie. On remarque que le nombre de non-geeks est beaucoup plus élevé que le nombre de geek (facteur 35). Cela est une limite à  notre analyse car les résultats ne sont pas exploitables sur un si petit échantillonnage.

```{r repartitionHommeFemme, fig.align='center', echo=FALSE}
# Créer un tableau croisé pour compter le nombre d'hommes et de femmes dans chaque catégorie
gender_counts <- table(data$geek, data$sex)

# Convertir le tableau croisé en un dataframe
gender_df <- as.data.frame(gender_counts)
names(gender_df) <- c("Catégorie", "Sexe", "Count")

# Créer un graphique à  barres empilées pour visualiser la répartition des hommes et des femmes
ggplot(gender_df, aes(x = Catégorie, y = Count, fill = Sexe)) +
  geom_bar(stat = "identity", position = "stack") +
  geom_text(aes(label = Count), position = position_stack(vjust = 0.5), color = "black", size = 2) +
  labs(title = "Répartition des hommes et des femmes parmi les catégories Geek et Non-Geek",
       x = "Catégorie",
       y = "Nombre d'étudiants",
       fill = "Sexe") +
  scale_fill_manual(values = c("yellow3", "mediumpurple")) +  # Couleurs pour les hommes (bleu) et les femmes (rose)
  theme_minimal()
```
<br>Sur ce graphique, on a décidé de compter le nombre d'hommes et de femmes dans chaque catégorie. On remarque que le nombre d'homme et de femme sont équivalents dans chaque catégorie. Donc cet aspect de l'analyse n'a pas d'importance.

```{r moyeneHommeFemme, fig.align='center', echo=FALSE}
means <- data %>%
  group_by(sex) %>%
  summarise(mean_math_score = mean(moyenneNote))

# Créer un graphique à  barres montrant les moyennes des notes en mathématiques pour les hommes et les femmes
ggplot(means, aes(x = sex, y = mean_math_score, fill = sex)) +
  geom_bar(stat = "identity") +
  geom_text(aes(label = round(mean_math_score, 2)), vjust = -0.5, color = "black", size = 4) +
  labs(title = "Moyenne des notes en mathématiques entre hommes et femmes",
       x = "Sexe",
       y = "Moyenne des notes en mathématiques",
       fill = "Sexe") +
  scale_fill_manual(values = c("yellow3", "mediumpurple")) +  # Couleurs pour les hommes (bleu) et les femmes (rose)
  theme_minimal()

```
<br>Sur ce graphique, on a décidé de comparer les moyennes des notes en mathématiques entre les hommes et les femmes. On remarque que les femmes et les hommes ont excatement la même moyenne. Cela montre que le sexe n'a pas d'impact sur les notes en mathématiques. 


### Partie analyse 

Dans cette partie nous tenterons d'analyser les différents résultats obtenus dans la partie exploratoire.

En effet, la précédente partie nous a permis de récolter beaucoup d'informations maintenant il s'agit de les comprendres.

On remarque que les geeks ont une moyenne en mathématiques légèrement plus élevée que les non-geeks. En effet, la médiane de ces derniers est légèrement plus haute. Cela s'est vu sur les deux premiers graphiques.

On a aussi pu remarquer que l'écart type des moyennes parmi les geeks était important à  tels points que nous pouvions les séparer en deux groupes distincts. Cela est visible sur le deuxième graphique.

Cela nous montre qu'il y a peu de chances qu'une corrélation entre ces deux critères existe.

Mais il est important de noter que le nombre d'étudiants considérés comme geeks est très faible par rapport aux non-geeks. Cela fausse grandement l'analyse sachant que l'on parle de moyenne donc la population de chaque catégorie devrait être équivalente.

Donc, d'après ce dataset, la conclusion est que les geeks n'ont pas de meilleures notes en mathématiques que les non-geeks. Même si cette conclusion est erronée due au manque d'échantillonnage, elle est cohérente avec les données récoltées.








## Question 4:  Y-a-t-il un lien entre la consommation d'alcool et l'échec scolaire, l'absentéisme ?

```{r RedefintionMat, include=FALSE, fig.align='center', echo=FALSE}

#Je n'ai maintenant que besoin de failures, Dalc, Walc, MoyenneNote donc je garde les colonnes qui m'interesse pour économiser les traitements
tableMat4 <- tableMat[,c("failures","Dalc","Walc","MoyenneNote")]
head(tableMat4)

nbPersonneDalc <- table(tablePor$Dalc)
print(nbPersonneDalc)

nbPersonneDalMat <- table(tableMat$Dalc)
print(nbPersonneDalMat)

```

### Partie exploration

L'arrivée dans le monde des études est souvent le moment de la découverte de l'alcool. Or sachant le caractère destructeur que peut avoir l'alcool sur la santé. Nous nous sommes posé la question de l'impact de l'alcool sur l'échec scolaire. Nous voulons savoir si l'alcool a un impact à  court terme sur ce groupe d'individu et pouvoir, peut être, le quantifier.

Nous voulons donc savoir si une forte consommation d'alcool a une influence négative sur les notes des individus. Nous pensons que l'alcool a une influence fortement négative sur les individus. Autrement formulés, nous pensons que les individus qui consomment le plus d'alcool sont ceux qui ont les moins bons résultats.

Les données qui m'interessent pour répondre à  cette question sont :

- **Failures** : nombre d'échecs aux classes précédentes (numérique : n si 1  n  3, sinon 4)
- **Dalc** : consommation d'alcool en semaine (numérique : de 1  très faible à  5  très élevé)
- **Walc** : consommation d'alcool le week-end (numérique : de 1  très faible à  5  très élevé)
- **MoyenneNote** : qui est la moyenne que nous avons calculée en faisant la moyenne des notes des 3 trimestres
  - G1 : note du premier trimestre (numérique : de 0 à  20)
  - G2 : note du deuxième trimestre (numérique : de 0 à  20)
  - G3 : note finale (numérique : de 0 à  20, cible de sortie)
  



```{r diagrammeConsoAlcoolMat, fig.align='center', echo=FALSE}
ggplot(data = tableMat, aes(x = factor(Dalc), y = MoyenneNote,fill=factor(Dalc))) +
  geom_violin() +
  stat_summary(fun = median, geom = "errorbar", aes(ymin = after_stat(y), ymax = after_stat(y), color = "Médiane"), width = 0.5, linetype = "dashed") + scale_fill_manual(
    name = "Consommation d'alcool", 
    values = c("lightblue", "lightgreen", "pink", "orange", "grey"),
    labels = c("très faible","faible","moyenne","forte","très forte")
  ) +
  scale_color_manual(values = "red", name = "Légende", labels = "Médiane") +
  labs(x = "Consommation d'alcool en semaine", y = "Moyenne des notes en math sur les trois semestres") +
  theme_minimal() +
  ggtitle("Répartition des notes en math par niveau de consommation d'alcool en semaine")+
  theme(legend.position = "right")  


```

## Analyse statistique des données

On remarque que la répartition statistique des moyennes en math n'est pas vraiment impactée par la consommation d'alcool. En effet, les groupes d'individus qui se notent 5/5 pour la consommation d'alcool ont même une médiane légèrement supérieure à  ceux qui se notent 1/5 (ceux qui consomment le moins).

Cependant, on peut noter que, plus la notation de la consommation d'alcool augmente, plus l'intervalle des notes à  tendances à  se resserer et à  se concentrer autour de la médiane.

On peut l'expliquer très simplement statistiquement par le nombre de personnes par catégorie. En effet, on sait que souvent les répartitions des notes suivent des lois normales. Or, les échantillons sont très grands pour une consommation d'alcool faible, mais très faibles pour une grosse consommation d'alcool. Donc les valeurs extrêmes seront alors moins probables. Cela peut alors affecter le nombre de valeur extrême.

### Répartition par catégorie de consommation d'alcool (Math)

Voici la répartition du nombre de personnes par catégorie :

| Consommation d'alcool en semaine | Nombre de personnes |
|----------------------------------|---------------------|
| 1                                | 276                 |
| 2                                | 75                  |
| 3                                | 26                  |
| 4                                | 9                   |
| 5                                | 9                   |

### Répartition par catégorie de consommation d'alcool (Portugais)

Comparons avec les notes en portugais oà¹ il y a deux fois plus d'individu par groupes:

| Consommation d'alcool en semaine | Nombre de personnes |
|----------------------------------|---------------------|
| 1                                | 451                 |
| 2                                | 121                 |
| 3                                | 43                  |
| 4                                | 17                  |
| 5                                | 17                  |

```{r diagrammeConsoAlcoolPort, fig.align='center', echo=FALSE}
ggplot(data = tablePor, aes(x = factor(Dalc), y = MoyenneNote,fill=factor(Dalc))) +
  geom_violin() +
  stat_summary(fun = median, geom = "errorbar", aes(ymin = after_stat(y), ymax = after_stat(y), color = "Médiane"), width = 0.5, linetype = "dashed") + 
  scale_fill_manual(
    name = "Consommation d'alcool", 
    values = c("lightblue", "lightgreen", "pink", "orange", "grey"),
    labels = c("très faible","faible","moyenne","forte","très forte")
  ) +
  scale_color_manual(values = "red", name = "Légende", labels = "Médiane")+
  labs(x = "Consommation d'alcool en semaine", y = "Moyenne des notes en math sur les trois semestres",title = "Répartition de la moyenne des notes en portugais par niveau de consommation d'alcool en semaine") +
  theme_minimal() +
  theme(plot.title = element_text(size=11,face="bold"))  


```

## Analyse des données

On remarque ici que la médiane des notes en Portugais chute légèrement quand la consommation d'alcool en semaine augmente. On retrouve ici, aussi le même phénomène de réduction de l'intervalle autour de la médianne quand la consommation d'alcool augmente.

Nous nous attendions à  des résultats beaucoup plus significatifs. Il est fort probable aussi, au vu de l'auto-évaluation de la consommation d'alcool sur une échelle de 1 à  5, qu'un biais de la centralité est apparu chez certains étudiants, ce qui a peut-être faussé les données.

On va donc visualiser les catégories de consommation d'alcool 1 et 2 ensembles et les catégories 4 et 5 ensembles pour observer un résultat qui tiendrait compte de ce biais.


```{r diagrammePortugaisRassemblement, fig.align='center', echo=FALSE}
tablePor$GroupedDalc <- factor(ifelse(tablePor$Dalc %in% c(1, 2), "1-2", ifelse(tablePor$Dalc %in% c(4, 5), "4-5", tablePor$Dalc)))

ggplot(data = tablePor, aes(x = GroupedDalc, y = MoyenneNote,fill=GroupedDalc)) +
  geom_violin() +
  stat_summary(fun = median, geom = "errorbar", aes(ymin = after_stat(y), ymax = after_stat(y), color = "Médiane"), width = 0.5, linetype = "dashed") +
  scale_fill_manual(
    name = "Consommation d'alcool", 
    values = c("lightblue", "lightgreen", "pink"),
    labels = c("faible et très faible","moyenne","forte et très forte")
  ) +
  scale_color_manual(values = "red", name = "Légende", labels = "Médiane") +
  labs(x = "Consommation d'alcool en semaine", y = "Moyenne des notes en portugais sur les trois semestres",title ="Répartition de la moyenne des notes en portugais par niveau de consommation d'alcool regroupé en semaine") +
  theme_minimal() +
  theme(plot.title = element_text(size=10,face="bold")) 


```

## Analyse des données

Avec ce graphique, on constate la même chute de la moyenne avec maintenant un échantillon plus important pour la catégorie 4-5. On remarque aussi, les gaussiennes grâce à  cette visualisation en violin, ce qui nous conforte à  croire que l'échantillon est un peu plus représentatif.

### Répartition par catégorie de consommation d'alcool

| Consommation d'alcool en semaine | Nombre de personnes |
|----------------------------------|---------------------|
| 1/2                              | 572                 |
| 3                                | 43                  |
| 4/5                              | 34                  |


On peut maintenant tisser une relation entre ceux qui consomme le plus et ceux qui ont une moyenne au cours de l'année plus faible. Cela peut venir de plusieurs facteurs. Les causes possibles sont soit le manque de données, soit le fait que l'alcool rende moins performant, soit que les moins performant ont tendance à se tourner vers l'alcool/la sociabilité/l'extrascolaire, soit un mixte des deux derniers facteurs.

On peut également se poser la question du redoublement des personnes qui consomment le plus d'alcool. En effet, les personnes, qui consomment le plus, sont peut-être ceux qui ont déjà  redoublé. Si c'est le cas, on pourrait s'interroger sur le rà´le du redoublement dans la moyenne de leurs notes actuelles.


```{r diagrammeRedoublementComparaison, fig.align='center', echo=FALSE}
proportions_redoublement <- tablePor %>%
  group_by(Dalc) %>%
  summarise(Total = n(),
            Redoublements = sum(failures >= 1), 
            PourcentageRedoublement = (Redoublements / Total) * 100) %>%
  ungroup()

ggplot(data = proportions_redoublement, aes(x = factor(Dalc), y = PourcentageRedoublement,fill = factor(Dalc))) +
  geom_bar(stat = "identity", position = position_dodge(), width = 0.7) +
  scale_fill_brewer(palette = "Set1", name = "Consommation d'alcool en semaine",labels = c("très faible", "faible", "moyen", "élevé", "très élevé")) +
  labs(title = "Pourcentage de redoublement par niveau de consommation d'alcool en semaine",x="Consommation d'alcool en semaine",y="Pourcentage de redoublement") +
  theme_minimal()

```

On remarque que notre hypothèse a été validé. Il y a bien plus de redoublement proportionnellement pour une plus grande consommation d'alcool. Ce qui peut compenser, le fait que la médiane des moyennes des notes sur les groupes 4 et 5 ne soit pas énormément inférieur à  la médiane des moyennes des notes des groupes 1 et 2.



## Question 5:  Le niveau d'étude des parents influence t'il le niveau scolaire des enfants ?

### Partie exploration

On entend régulièrement que les parents ayant fait de longues études poussent leurs enfants à faire de même et a excellé dans leur vie scolaire. Cela peut créer une énorme pression sur les épaules des enfants et parfois même engendrer des drames. En effet, il arrive que certains poussé à bout tombent dans une dépression ou même pire.
On retrouve souvent ce genre d'histoire dans les pays ou le niveau d'éducation est représentatif du niveau social. 
Par exemple les pays asisatiques sont très favorables et ce genre de système.

Nous allons donc essayer de voir si cette affirmation est vraie en analysant un dataset d'étudiants espagnole. Ce pays n'est pas soumis à ce genre de mentalité donc nous verrons si cela a un effet.

Les données qui m'interessent pour répondre à  cette question sont :

- **Medu** : niveau d'éducation de la mère (numérique : 0 - aucun, 1 - primaire, 2 - 5e-9e année, 3 - secondaire, 4 - supérieure)
- **Fedu** : niveau d'éducation du père (numérique : 0 - aucun, 1 - primaire, 2 - 5e-9e année, 3 - secondaire, 4 - supérieure)
- **MoyenneNote** : qui est la moyenne que nous avons calculée en faisant la moyenne des notes des 3 trimestres
  - G1 : note du premier trimestre (numérique : de 0 à  20)
  - G2 : note du deuxième trimestre (numérique : de 0 à  20)
  - G3 : note finale (numérique : de 0 à  20, cible de sortie)

```{r correlationEtudeMere, fig.align='center', echo=FALSE}
# Charger le dataset
df <- all_students

# Convertir les variables pertinentes en facteurs
df$Medu <- factor(df$Medu, levels = 0:4, labels = c("Aucun", "Primaire", "5e-9e année", "Secondaire", "Supérieure"))
df$Fedu <- factor(df$Fedu, levels = 0:4, labels = c("Aucun", "Primaire", "5e-9e année", "Secondaire", "Supérieure"))

# Créer une nouvelle variable représentant les résultats scolaires moyens
df <- df %>%
  mutate(moyenne_notes = rowMeans(select(., G1:G3), na.rm = TRUE))

# Résumer les résultats scolaires moyens en fonction du niveau d'éducation des parents
education_results <- df %>%
  group_by(Medu, Fedu) %>%
  summarise(moyenne_notes = mean(moyenne_notes, na.rm = TRUE))

# Visualiser la relation entre le niveau d'éducation de la mère et les résultats scolaires des enfants
ggplot(df, aes(x = Medu, y = moyenne_notes)) +
  geom_boxplot() +
  labs(title = "Relation entre le niveau d'éducation de la mère et les résultats scolaires",
       x = "Niveau d'éducation de la mère",
       y = "Moyenne des résultats scolaires") +
  theme_minimal()

```

Sur ce graphique, on peut voir que la moyenne des notes des enfants est plus élevée lorsque le niveau d'éducation de la mère est plus élevé. Cela est cohérent avec l'idée que les parents ayant fait de longues études poussent leurs enfants à faire de même et a excellé dans leur vie scolaire.
On remarque quelque chose d'étrange, c'est lorsque le niveau d'éducation de la mère est nul la moyenne des notes est la plus élevée . Dans ce cas de figure, on peut difficilement imaginer que la mère à mis une pression énorme sur son enfant pour qu'il excelle et pourtant c'est le cas. Cela peut être dû à  plusieurs facteurs, comme le fait que la mère soit très présente pour aider son enfant, ou que l'enfant soit très motivé pour réussir.
On remarque aussi un plus grand écart-type lorsque le niveau d'éducation est non nul ce qui peut être dû à un plus grand nombre de données.

```{r correlationEtudePere, fig.align='center', echo=FALSE}

# Visualiser la relation entre le niveau d'éducation du père et les résultats scolaires des enfants
ggplot(df, aes(x = Fedu, y = moyenne_notes)) +
  geom_boxplot() +
  labs(title = "Relation entre le niveau d'éducation du père et les résultats scolaires",
       x = "Niveau d'éducation du père",
       y = "Moyenne des résultats scolaires") +
  theme_minimal()

``` 

Ce graphique représente exactement la même chose que le précédent a la différence que celui-là représente le niveau d'éducation du père. On remarque que la moyenne des notes des enfants est plus élevée lorsque le niveau d'éducation du père est plus élevé. Cela est cohérent avec l'idée que les parents ayant fait de longues études poussent leurs enfants à faire de même et a excellé dans leur vie scolaire.
Mais comme pour le graphique précédent on remarque que les enfants dont le père a un niveau d'étude nul ont une moyenne élevée. Plus que celles avec un père ayant un niveau d'éducation 5e-9e années. 

```{r correlationEtudeParent, fig.align='center', echo=FALSE}
# Visualiser la relation combinée entre le niveau d'éducation des parents et les résultats scolaires des enfants
ggplot(education_results, aes(x = Medu, y = moyenne_notes, fill = Fedu)) +
  geom_bar(stat = "identity", position = "dodge") +
  labs(title = "Relation entre le niveau d'éducation des parents et les résultats scolaires",
       x = "Niveau d'éducation de la mère",
       y = "Moyenne des résultats scolaires",
       fill = "Niveau d'éducation du père") +
  theme_minimal()
```

Ce graphique représente la relation entre le niveau d'éducation, cette fois des deux parents, et les résultats scolaires des enfants. Ce graphique est intéressant car il permet de voir si le niveau d'éducation des deux parents a un impact plus important que le niveau d'éducation d'un seul des deux parents. On remarque que les enfants dont les deux parents ont un niveau d'éducation nul ont une moyenne plus élevée que ceux dont un des deux parents a un niveau d'éducation nul. La meilleure moyenne est assez inattendue car elle correspond à des parents dont le niveau d'étude est globalement faible avec une mère "aucun" et un père "5e-9e année".
Mais plus les parents ont un niveau d'étude élevé plus les moyennes sont homogènes ce qui prouve un certain impacte sur l'éducation des enfants.


### Partie analyse 

Dans cette partie nous tenterons d'analyser les différents résultats obtenus dans la partie exploratoire.

Pour récapituler ce que nous avons observé dans la partie exploratoire, nous avons pu voir que les enfants dont les parents ont un niveau d'éducation élevé ont en moyenne de meilleures notes que les enfants dont les parents ont un niveau d'éducation faible.  
Nous avons aussi pu voir que le fait que ce soit le père ou la mère qui ait un niveau d'éducation élevé n'a pas d'impact sur les notes des enfants.
Enfin, nous avons pu voir que les enfants dont les deux parents ont un niveau d'éducation nul ont en moyenne de meilleures notes que les enfants dont un des deux parents a un niveau d'éducation nul.

Toutes ces données nous amènent à penser que le postulat réalisé au début de l'enquête est vrai. Le niveau d'études des parents a un réel impact sur les résultats scolaires de l'enfant. Cela peut s'expliquer par le fait que les parents ayant un niveau d'étude élevé ont plus de connaissances et de compétences pour aider leurs enfants dans leurs études. De plus, ils ont souvent une meilleure situation financière qui leur permet de mettre leurs enfants dans de bonnes écoles et de leur offrir des cours particuliers. Enfin, les parents ayant un niveau d'étude élevé ont souvent une meilleure culture générale et une meilleure compréhension des enjeux de l'éducation, ce qui les pousse à encourager leurs enfants à réussir dans leurs études.

Mais cette analyse a aussi des limites. En effet, le niveau d'étude des parents n'est pas le seul facteur qui influence les résultats scolaires des enfants. D'autres facteurs comme le niveau socio-économique de la famille, le niveau d'éducation des enseignants, le niveau de motivation des enfants, le climat scolaire, etc. peuvent aussi avoir un impact sur les résultats scolaires des enfants. Il faudrait donc prendre en compte tous ces facteurs pour avoir une vision plus complète de la situation.


## Question 6:  Les étudiants vivant dans un milieu rural sont-ils voués à rester dans leur campagne ?


La potentielle existence d'une différence de vie entre les personnes vivant en ville et celles à la campagne est fréquemment le sujet de débats. Dans cette partie de notre projet explorartoire nous allons nous concentrer sur la manière dont les étudiants de milieux ruraux et urbains appréhendent les études supérieures et le choix de leur école. Cette thématique est pertinente car nous savons que les jeunes ayant grandi il y a plusieurs décennies dans les campagnes étaient d'une certaine manière condamnés à y rester et à reprendre la profession de leurs parents. Ce phénomène est-il rest inchangé ou, au contraire, est-il devenu obsolète depuis?

Pour répondre à cette problématique nous allons nous concentrer sur certaines features fournies dans le dataset:
- **Address** :type d'adresse du domicile de l'étudiant (binaire : 'U' pour urbain ou 'R' pour rural)
- **Traveltime** : temps de trajet domicile-école (numérique : 1 - <15 min., 2 - 15 à 30 min., 3 - 30 min. à 1 heure, ou 4 - >1 heure)
- **Higher** : souhaite poursuivre une éducation supérieure (binaire : oui ou non)
- **Reason** :raison de choisir cette école (nominal : proche de 'home', réputation de l'école, préférence de 'course' ou 'other')

Tout d'abord, il semble évident de vouloir savoir si les jeunes vivant en milieu rural s'intéressent à la poursuite d'études en supérieur. Il semble également pertinent de comparer la réponse récoltée avec celle qu'auraient proposé les jeunes vivant en milieu urbain.

```{r higerAdress, fig.align='center', echo=FALSE}
# Charger le dataset
data <- all_students[,c("address","traveltime","higher","reason")]

# Calculer les pourcentages par rapport au total des étudiants pour chaque valeur de address
df_summary <- data %>%
  group_by(higher, address) %>%
  summarise(count = n(), .groups = 'drop') %>%
  ungroup() %>%
  group_by(address) %>%
  mutate(total = sum(count)) %>%
  mutate(percentage = count / total * 100)

# Création du barplot avec ggplot2
ggplot(df_summary, aes(x = higher, y = percentage, fill = address)) +
  geom_bar(stat = "identity", position = "dodge") +
  labs(title = "Pourcentage d'étudiants souhaitant poursuivre une éducation supérieure",
       x = "Souhaite poursuivre une éducation supérieure",
       y = "Pourcentage",
       fill = "Milieu de vie") +
  theme_minimal()

```

Nous constatons un intérêt pour les études supérieures légèrement plus faible dans les milieux ruraux que dans les milieux urbains. Cela montre directement une forte différence avec la situation que nos grands-parents vivant en milieu rural ont connu. En effet, les jeunes ont désormais, notamment grâce à internet, une connaissance beaucoup plus poussée des possibilités qui leurs sont offertes hors de leur campagne.
Même si l'intérêt pour les études supérieures semblent identiques en milieu rural qu'en milieu urbain, il serait pertinent de s'interroger sur les facteurs pouvant causer le faible écart que nous avons rencontré.

Pour cela, nous allons tenter de lier les features  **Reason** et  **Traveltime** afin de découvrir ce qui motiverait les jeunes à rejoindre une école et s'ils sont prêts à faire plus de distance chaque jour pour la rejoindre.

```{r reasonAdress, fig.align='center', echo=FALSE}

# Calculer les pourcentages pour chaque raison au sein de chaque type d'adresse
data_percent <- data %>%
  group_by(address, reason) %>%
  summarise(count = n(), .groups = 'drop') %>%
  ungroup() %>%
  group_by(address) %>%
  mutate(total = sum(count)) %>%
  mutate(percent = count / total * 100)

# Créer le graphique à barres empilées
ggplot(data_percent, aes(x = address, y = percent, fill = reason)) +
  geom_bar(stat = "identity", position = "fill") +
  labs(title = "Répartition en pourcentage des raisons pour chaque type d'adresse",
       x = "Type d'adresse",
       y = "Pourcentage",
       fill = "Raison") +
  scale_y_continuous(labels = scales::percent) +
  theme_minimal()


```

```{r traveltimeAdress, fig.align='center', echo=FALSE}

ggplot(data, aes(x = address, y = traveltime)) +
  geom_violin(fill = "lightgreen") +
  stat_summary(fun = median, geom = "errorbar", aes(ymin = after_stat(y), ymax = after_stat(y), color = "Médiane"), width = 0.5, linetype = "dashed") + 
  scale_color_manual(values = "red", name = "Légende", labels = "Médiane") +
  labs(x = "Milieu de vie", y = "Temps de trajet domcile - école",title = "Répartition du temps de trajet domcile - école en fonction du milieu de vie") +
  theme_minimal() +
  theme(plot.title = element_text(size=11,face="bold"))  

```

Nous constatons plusieurs phénomènes notables sur ces graphiques.
Tout d'abord, que ce soit en milieu rural ou en milieu urbain, la raison de choisir une école par les étudiants est loin d'être unanime. En effet, tandisque certains privilégient les cours proposés dans l'école, d'autres donnent de l'importance à la proximité avec leur lieu de vie, à la réputation de l'école ou à autre chose.

Une similitude existe entre le choix des étudiants ruraux et celui des étudiants urbains. Des deux côtés environ 25% des étudiants choisissent leur école en fonction de la réputation. Cela permet au passage de déconstruire le mythe que les écoles réputées sont réservées aux étudiants vivant dans les grandes villes.

Toutefois, certaines proportions varient. La part d'étudiant choisissant leur école en fonction de sa proximité avec leur lieu de vie est plus faible dans les milieux ruraux. Or nous savons que la densité d'écoles est plus faible en milieu rural qu'en milieu urbain. En effet, au Portugal (car notre dataset provient de ce pays), il existe une différence notable dans la densité des écoles entre les zones rurales et urbaines. En général, les zones urbaines, telles que Lisbonne et Porto, disposent d'un nombre plus élevé d'écoles en raison de la densité de population plus élevée. En revanche, les zones rurales, souvent moins peuplées, ont moins d'écoles, ce qui peut entraîner des défis d'accès à l'éducation pour les élèves de ces régions. Ainsi, les étudiants vivant en campagne sont prêts à s'éloigner de chez eux afin de privilégier leur éducation scolaire. Le graphique représentant la répartition du temps de trajet domcile - école en fonction du milieu de vie confirme cette idée en prouvant que les étudiants vivant en milieu rural mettent quotidiennement plus de temps pour rejoindre leur école que les étudiants vivant en ville. 

Enfin, la proximité avec le domicile est le critère le moins important dans le choix de leur école pour les étudiants vivant en milieu rural. Ils privilégient la réputation, les cours proposés ou autre chose. Cela prouve que, de nos jours, les étudiants ayant grandi en campagne s'ouvrent aux opportunités existantes plus loin de chez eux et préfèrent en sortir pour obtenir la meilleure éducation scolaire possible. Cette progression par rapport à la situation qu'ont connu nos grands-parents en milieu rural a principalement été possible grâce à la démocratisation d'internet, des moyens de transport et de l'accès aux grandes écoles.

# Question 7 : Travailler plus pour gagner plus?

### Partie exploration

Le bon sens voudrait que ceux qui travaillent le plus soient ceux qui ont les meilleurs résultats. Tout de même, nous somme curieux de vérifier cette hypothèse. 
Pour analyser cette hypothèse, nous allons avoir besoin des données suivantes :

- **studytime** : temps d'étude hebdomadaire (numérique : 1 - <2 heures, 2 - 2 à 5 heures, 3 - 5 à 10 heures, ou 4 - >10 heures)
- **schoolsup** : soutien éducatif supplémentaire (binaire : oui ou non)
- **famsup** : soutien éducatif familial (binaire : oui ou non)
- **paid** : cours supplémentaires payants dans la matière du cours (Mathématiques ou Portugais) (binaire : oui ou non)
- **MoyenneNote** : qui est la moyenne que nous avons calculée en faisant la moyenne des notes des 3 trimestres
  - G1 : note du premier trimestre (numérique : de 0 à  20)
  - G2 : note du deuxième trimestre (numérique : de 0 à  20)
  - G3 : note finale (numérique : de 0 à  20, cible de sortie)

Commençons simplement par une répartition de la moyenne des notes en fonction du temps d'étude hebdomadaire:


```{r diagramNoteTempsEtude, fig.align='center', echo=FALSE}
ggplot(data = all_students, aes(x = factor(studytime), y = MoyenneNote,fill=factor(studytime))) +
  geom_boxplot() +
  labs(x = "Temps d'étude hebdomadaire", y = "Moyenne des notes sur les trois semestres") +
  scale_fill_manual(
    name = "Temps d'étude hebdomadaire", 
    values = c("lightblue", "lightgreen", "pink", "orange"),
    labels = c("1 à 2 heures","2 à 5 heures","5 à 10 heures","plus de 10 heures")
  ) +
  theme_minimal() +
  ggtitle("Répartition des notes en fonction du temps d'étude hebdomadaire")+
  theme(legend.position = "right")  

```
Parmis les trois catégories, on remarque des répartitions différentes. La médiane de la moyenne des résultats de la première catégorie de temps d'étude augmente d'environ deux points par rapport à la première catégorie (de 1 heure à 10 heures de temps d'étude). En revanche, la quatrième catégorie à une médiane plus faible que la troisième. 

On peut donc constater que, plus les individus travaillent, plus il devient probable qu'ils aient de meilleurs résultats. Cepedant, le nombre d'heures de travail n'est pas le seul paramètre dans la réussite des élèves. Si cela avait été le cas, l'écart entre les différentes catégories aurait été proportionnel à la différence de temps d'étude. Or, ce n'est pas le cas, comme le montre la dernière catégorie.

Un facteur intéressant à ajouter à l'analyse est la part de l'aide du soutien éducatif dans la réussite scolaire de l'élève. Pour observer l'impact de ce facteur, j'ai créé une autre colonne appelée "generalsup" qui correspond à l'opérateur logique "OR" des deux colonnes : "famsup" (soutient scolaire familiale) et "studysup" (soutient scolaire à l'école). C'est-à-dire que si au moins une des colonnes a un "yes", alors "generalsup" prendra la valeur de "yes". Cette colonne rassemble donc tout les élèves qui participe à des cours de soutient scolaire.


```{r diagSoutientScolaireReussite, fig.align='center', echo=FALSE}
ggplot(data = all_students, aes(x = factor(generalsup), y = MoyenneNote,fill=factor(generalsup))) +
  geom_boxplot() +
  labs(x = "Soutien scolaire", y = "Moyenne des notes sur les trois semestres") +
  scale_fill_manual(
    name = "Soutien scolaire", 
    values = c("red", "blue"),
    labels = c("non","oui")
  ) +
  theme_minimal() +
  ggtitle("Répartition des notes en fonction du soutient scolaire")+
  theme(legend.position = "right")  

```
Statistiquement, les étudiants qui n'assistent pas à du soutien scolaire ont un niveau équivalent à ceux qui assistent à du soutien scolaire. À première vue, ce résultat semble contre-intuitif. Cela voudrait-il dire que le soutien scolaire ne sert à rien ? En fait, nous pensons que ce résultat surprenant s'explique par les motifs de prendre du soutien scolaire. En effet, nous pensons que le soutien scolaire n'est pas vraiment culturel, c'est-à-dire qu'il ne sert pas de tremplin pour avoir de bien meilleures notes, mais qu'il est vu comme un moyen d'obtenir des résultats corrects. Cette théorie s'appuie sur le fait que plus de 3/4 de l'échantillon qui prend du soutien scolaire a une moyenne en dessous de 13.

Les données qui auraient été intéressantes à avoir pour une analyse plus poussée de l'influence du soutien scolaire seraient un détail des résultats avant, puis pendant le soutien scolaire. En effet, nous ne pouvons pas savoir ici si les étudiants (avec et sans soutien scolaire) avaient le même niveau scolaire à l'origine, car ceux qui suivent du soutien scolaire cherchent peut-être à rattraper leurs lacunes acquises auparavant sans soutien scolaire.


Un autre élément intéressant dans l'analyse des résultats scolaires est l'investissement pécuniaire. Faut-il payer plus pour gagner plus tard davantage ? Est-ce que ceux qui prennent des cours particuliers payants ont de meilleurs résultats que les autres ?

```{r diagPayantScolaireReussite, fig.align='center', echo=FALSE}
ggplot(data = all_students, aes(x = factor(paid), y = MoyenneNote,fill=factor(paid))) +
  geom_boxplot() +
  labs(x = "Cours particulier payant", y = "Moyenne des notes sur les trois semestres") +
  theme_minimal() +
  scale_fill_manual(
    name = "Cours payant", 
    values = c("red", "blue"),
    labels = c("non","oui")
  ) +
  ggtitle("Répartition des notes en fonction de la prise de cours particulier payant")+
  theme(legend.position = "right")  

```
On retrouve la même observation que précédemment. Les personnes qui prennent des cours payants n'ont pas, statistiquement, de meilleurs résultats que ceux qui n'en prennent pas. L'analyse ici est la même que précédemment. Nous ne pouvons pas savoir si c'est le fait d'avoir eu de mauvaises notes auparavant qui fait que l'échantillon des personnes qui prennent des cours payants est plus mauvais que les autres, ou si c'est l'absence d'influence des cours payants sur leurs résultats scolaires qui mène à ce constat.

## Question 8: Existe-t-il une corrélation entre le temps de trajet entre le domicile et l'université et l'absentéisme chez les étudiants ?

Etant étudiants, nous nous devons de participer aux cours qui nous sont dispensés : c'est une devoir ainsi qu'un besoin qu'il faut respecter. En revanche, nous savons que parmi les étudiants, certains sont plus réguliers que d'autres. On peut retrouver certains systématiquement à l'université et d'autres certainement pas.
Mais pourquoi certains sont-ils plus absents que d'autres ? Est-ce par choix ou par handicap ?
Ici nous allons essayer de répondre en partie à cette question, en essayant de voir s'il y a un lien entre le temps de trajet et l'absentéisme en cours.

Dans notre dataset, nous avons les informations pour chaque étudiant de : 
- temps de trajet domicile-école entre 1 et 4 (avec : 1 - <15 min., 2 - 15 à 30 min., 3 - 30 min. à 1 heure, ou 4 - >1 heure)
- leur nombre d'absences scolaires sur les 93 cours de l'année


Dans un premier temps, il est nécessaire de récupérer les informations dont on a besoin. Ici, on extrait directement le nombre d'absences moyen par catégorie de temps de trajet sur les élèves de Portugais et de Maths, et on visualise.

```{r Question 8 : Distance correlée absentéisme, fig.align='center', echo=FALSE}
#Question 8 :
#La temps de trajet jusque son lieu d'étude est-il un facteur d'absence ?

#Etablir les deux datasets avec le nombre d'absences et le temps de trajet
distance_abs_dataset_mat <- aggregate(absences ~ traveltime, data = student_mat, FUN = mean)
distance_abs_dataset_por <- aggregate(absences ~ traveltime, data = student_por, FUN = mean)

#Nombre d'absences moyen : sur le total des 93 cours de l'année

#Maths
ggplot(distance_abs_dataset_mat, aes(x = traveltime, y = absences)) +
  geom_bar(stat = "identity", fill = "cyan3") +
  labs(title = "Nombre moyen d'absences en fonction du temps de trajet \nchez les élèves de Maths",
       x = "Temps de trajet", y = "Nombre moyen d'absences") +
  scale_x_continuous(breaks = c(1, 2, 3, 4), labels = c("<15 min", "15 à 30 min", "30 min à 1h", "> 1h")) +
  theme_minimal()

#Portugais
ggplot(distance_abs_dataset_por, aes(x = traveltime, y = absences)) +
  geom_bar(stat = "identity", fill = "cyan3") +
  labs(title = "Nombre moyen d'absences en fonction du temps de trajet \nchez les élèves de Portugais",
       x = "Temps de trajet", y = "Nombre moyen d'absences") +
  scale_x_continuous(breaks = c(1, 2, 3, 4), labels = c("<15 min", "15 à 30 min", "30 min à 1h", "> 1h")) +
  theme_minimal()

```
On remarque immédiatement quelque chose d'assez étonnant : globalement, plus les élèves ont un temps de trajet élevé, moins ils sont absents. Cela s'observe plus particulièrement sur le dataset des élèves de maths, là ou sur la classe de portugais, l'absence moyenne est plus linéaire, mais n'infirme pas non plus la tendance observée en maths.

Ces résultats semblent illogique, plus le temps de trajet est long, plus l'absentéisme est un gain de temps pour un étudiant. De plus, avec plus de temps de trajet, les problèmes de transport sont plus courants et donc retards et absentéismes devraient l'être aussi.

Nous allons donc essayer de comprendre ces résultats, peut être que certains étudiants faussent les résultats avec un nombre d'absence extraordinaire.

Visualisons ceci en récupérant les données de chaque étudiant et en les représentant sur un violin plot classé par catégorie de temps de trajet. Le but est d'observer la répartition du nombre d'absences des étudiants.

```{r Question 8 : Distance correlée absentéisme, fig.align='center', echo=FALSE}

#Etablir les deux datasets avec le nombre d'absences et le temps de trajet
distance_abs_dataset_mat2 <- student_mat[, c("absences", "traveltime")]
distance_abs_dataset_por2 <- student_por[, c("absences", "traveltime")]


# Maths
ggplot(distance_abs_dataset_mat2, aes(x = factor(traveltime), y = absences)) +
  geom_violin(fill = "cyan3") +
  labs(title = "Nombre d'absences en fonction du temps de trajet \nchez les élèves de Maths",
       x = "Temps de trajet", y = "Nombre d'absences") +
  scale_x_discrete(labels=c("1" = "<15 min", "2" = "15 à 30 min",
                              "3" = "30 min à 1h", "4" = "> 1h")) +
  theme_minimal()

# Portugais
ggplot(distance_abs_dataset_por2, aes(x = factor(traveltime), y = absences)) +
  geom_violin(fill = "cyan3") +
  labs(title = "Nombre d'absences en fonction du temps de trajet \nchez les élèves de Portugais",
       x = "Temps de trajet", y = "Nombre d'absences") +
  scale_x_discrete(labels=c("1" = "<15 min", "2" = "15 à 30 min",
                              "3" = "30 min à 1h", "4" = "> 1h")) +
  theme_minimal()
```
Ce qu'on remarque tout de suite, c'est que les formes des violon plot se ressemblent plutôt bien entre les différentes catégories de temps de trajet et les différents cours. Le nombre d'absences à l'air de se comporter uniformément entre les différents temps de trajet.

Ce qu'on identifie ensuite, et qui diffère en fonction des catégories, c'est que sur les temps de trajet 1 et 2, il y a la présence d'un petit groupe de personne avec un nombre d'absences très élevé. 
Ce groupe est un facteur d'augmentation de la moyenne d'absences important et étire grandement la forme du violin vers le haut.

Essayons de visualiser ce groupe à l'aide d'un box plot afin de se rendre mieux compte de ces individus.

```{r Question 8 : Distance correlée absentéisme, fig.align='center', echo=FALSE}

#Boxplot

# Maths
ggplot(distance_abs_dataset_mat2, aes(x = factor(traveltime), y = absences)) +
  geom_boxplot(fill = "cyan3") +
  labs(title = "Nombre d'absences en fonction du temps de trajet \nchez les élèves de Maths",
       x = "Temps de trajet", y = "Nombre d'absences") +
  scale_x_discrete(labels=c("1" = "<15 min", "2" = "15 à 30 min",
                              "3" = "30 min à 1h", "4" = "> 1h")) +
  theme_minimal()

# Portugais
ggplot(distance_abs_dataset_por2, aes(x = factor(traveltime), y = absences)) +
  geom_boxplot(fill = "cyan3") +
  labs(title = "Nombre d'absences en fonction du temps de trajet \nchez les élèves de Portugais",
       x = "Temps de trajet", y = "Nombre d'absences") +
  scale_x_discrete(labels=c("1" = "<15 min", "2" = "15 à 30 min",
                              "3" = "30 min à 1h", "4" = "> 1h")) +
  theme_minimal()
```

A l'aide du box plot, on remarque plus facilement les individus sortant du groupe global d'absences moyennes. Il sont assez nombreux sur les catégories de temps de trajet 1 et 2, et semblent fausser grandement la valeur de nombre d'absences moyen. En effet, certains se placent à plus de 50 absences, ce qui est 10 fois la moyenne.

On remarque également le comportement du nombre d'absences moyennes hors extrémas. Ce que l'on identifie, c'est que en dehors des quelques élèves très peu assidus, le comportement du nombre d'absences ne semble pas évoluer avec le temps de trajet. Les 4 box plot sont relativement similaires.

Aussi, on observe que plus le temps de trajet est long, moins le nombre d'individus en dehors des normes semble être élevé. 
Mais cela est sûrement dû au nombre d'individus dans chacun des échantillons.
Il serait intéressant de savoir combien d'individus sont présents dans chacun des échantillons afin d'avoir une analyse plus correcte.

```{r Question 8 : Distance correlée absentéisme, fig.align='center', echo=FALSE}

#Combien d'étudiants dans chaque catégorie ?

# Maths
ggplot(distance_abs_dataset_mat2, aes(x = factor(traveltime))) +
  geom_bar(stat = "count", fill = "chartreuse1") +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5) +
  labs(title = "Nombre d'élèves en fonction du temps de trajet \nchez les élèves de Maths",
       x = "Temps de trajet", y = "Nombre d'élèves") +
  scale_x_discrete(labels=c("1" = "<15 min", "2" = "15 à 30 min",
                              "3" = "30 min à 1h", "4" = "> 1h")) +
  theme_minimal()

# Portugais
ggplot(distance_abs_dataset_por2, aes(x = factor(traveltime))) +
  geom_bar(stat = "count", fill = "chartreuse1") +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5) +
  labs(title = "Nombre d'élèves en fonction du temps de trajet \nchez les élèves de Portugais",
       x = "Temps de trajet", y = "Nombre d'élèves") +
  scale_x_discrete(labels=c("1" = "<15 min", "2" = "15 à 30 min",
                              "3" = "30 min à 1h", "4" = "> 1h")) +
  theme_minimal()
```

Tout se suite, on comprend pourquoi il y avait une plus grande présence d'individus hors normes dans certains groupes : respectivement, les groupes 1 et 2 sont bien plus imposants que les 3 et 4.

Une meilleure analyse aurait donc été de d'un côté, combiner directement les temps de trajets 3 et 4 afin d'avoir des valeurs se basant sur un plus grand nombre d'individus, et d'un autre côté de regarder le nombre d'absences médian afin de limiter l'effet des quelques étudiants très peu assidus.

En appliquant ces améliorations, on peu donc obtenir ceci.

```{r Question 8 : Distance correlée absentéisme, fig.align='center', echo=FALSE}
#Question 8 :
#La temps de trajet jusque son lieu d'étude est-il un facteur d'absence ?

distance_abs_dataset_mat3 <- student_mat
distance_abs_dataset_por3 <- student_por

#Créer une nouvelle variable qui regroupe les catégories traveltime = 3 et traveltime = 4 en une seule catégorie traveltime >= 3
# Créer une nouvelle variable traveltime_cat à partir de la variable traveltime
distance_abs_dataset_mat3$traveltime_cat <- ifelse(distance_abs_dataset_mat3$traveltime == 3 | distance_abs_dataset_mat3$traveltime == 4, "3+", as.character(distance_abs_dataset_mat3$traveltime))
distance_abs_dataset_por3$traveltime_cat <- ifelse(distance_abs_dataset_por3$traveltime == 3 | distance_abs_dataset_por3$traveltime == 4, "3+", as.character(distance_abs_dataset_por3$traveltime))

# Convertir la nouvelle variable en facteur
distance_abs_dataset_mat3$traveltime_cat <- as.factor(distance_abs_dataset_mat3$traveltime_cat)
distance_abs_dataset_por3$traveltime_cat <- as.factor(distance_abs_dataset_por3$traveltime_cat)


#Etablir les deux datasets avec le nombre d'absences et le temps de trajet
distance_abs_dataset_mat3 <- aggregate(absences ~ traveltime_cat, data = distance_abs_dataset_mat3, FUN = median)
distance_abs_dataset_por3 <- aggregate(absences ~ traveltime_cat, data = distance_abs_dataset_por3, FUN = median)

#Nombre d'absences moyen : sur le total des 93 cours de l'année

#Maths
ggplot(distance_abs_dataset_mat3, aes(x = traveltime_cat, y = absences)) +
  geom_bar(stat = "identity", fill = "cyan3") +
  labs(title = "Nombre median d'absences en fonction du temps de trajet \nchez les élèves de Maths",
       x = "Temps de trajet", y = "Nombre moyen d'absences") +
  scale_x_discrete(labels=c("1" = "<15 min", "2" = "15 à 30 min",
                              "3+" = ">30 min")) +
  theme_minimal()

#Portugais
ggplot(distance_abs_dataset_por3, aes(x = traveltime_cat, y = absences)) +
  geom_bar(stat = "identity", fill = "cyan3") +
  labs(title = "Nombre median d'absences en fonction du temps de trajet \nchez les élèves de Portugais",
       x = "Temps de trajet", y = "Nombre median d'absences") +
  scale_x_discrete(labels=c("1" = "<15 min", "2" = "15 à 30 min",
                              "3+" = ">30 min")) +
  theme_minimal()

```
En appliquant ces modifications, on identifie clairement que le temps de trajet ne semble pas d'avoir d'influence sur le nombre d'absences.


  Comme on a vu que le temps de trajet ne semble pas vraiment influer sur l'absentéisme, on reste un peu sur notre faim. On a pas trouvé de variable corrélée à l'absentéisme ...
Il est intéressant de se demander : qu'est ce qui serait correlé à ces absences alors ? 
Ainsi, une autre idée nous vient tout de suite en tête : le temps d'étude ! En effet, un étudiant travaillant beaucoup en dehors des cours, devrait logiquement aussi participer aux cours.

On va donc utiliser la variable studytime :
- c'est le temps d'étude hebdomadaire entre 1 et 4 ( 1 - <2 heures, 2 - 2 à 5 heures, 3 - 5 à 10 heures, ou 4 - >10 heures)

On se pose donc la question suivante : les étudiants travaillants plus en dehors des cours, sont-ils plus ou moins absents ?

En effet la question fait sens car deux possibilités peuvent être vraies.
1 - Les étudiants travaillant beaucoup en dehors des cours, sont sérieux et assidus et donc participent plus aux cours.
2 - Les étudiants qui travaillent beaucoup en dehors des cours, travaillent autant parce qu'ils n'étaient justement pas en cours. Ils se doivent donc de rattraper leur retard.

Vérifions cela.

Pour ceci, nous prenons la même méthodologie que précedemment mais nous changeons la variable travel_time avec studytime.
Regardons le nombre d'absences moyen en fonction du temps d'étude.

```{r Question 8 : Distance correlée absentéisme, fig.align='center', echo=FALSE}

#En fonction du studytime ?

#Etablir les deux datasets avec le nombre d'absences et le temps de trajet
studytime_abs_dataset_mat <- aggregate(absences ~ studytime, data = student_mat, FUN = mean)
studytime_abs_dataset_por <- aggregate(absences ~ studytime, data = student_por, FUN = mean)

#Maths
ggplot(studytime_abs_dataset_mat, aes(x = studytime, y = absences)) +
  geom_bar(stat = "identity", fill = "lightblue") +
  labs(title = "Nombre moyen d'absences en fonction du temps d'étude \nchez les élèves de Maths",
       x = "Temps d'étude hebdomadaire", y = "Nombre moyen d'absences") +
  scale_x_continuous(breaks = c(1, 2, 3, 4), labels = c("<2 heures", "2 à 5 heures", "5 à 10 heures", ">10 heures")) +
  theme_minimal()

#Portugais
ggplot(studytime_abs_dataset_por, aes(x = studytime, y = absences)) +
  geom_bar(stat = "identity", fill = "lightblue") +
  labs(title = "Nombre moyen d'absences en fonction du temps d'étude \nchez les élèves de Portugais",
       x = "Temps d'étude hebdomadaire", y = "Nombre moyen d'absences") +
  scale_x_continuous(breaks = c(1, 2, 3, 4), labels = c("<2 heures", "2 à 5 heures", "5 à 10 heures", ">10 heures")) +
  theme_minimal()

```
Et l'on observe tout de suite quelque chose de net : en effet, en maths et en portugais, les étudiants travaillant plus semblent sensiblement moins absents.


Regardons tout de même combien d'étudiants sont considérés dans chacune des catégories. Peut-être que comme précedemment, les échantillons ne sont pas suffisants dans certaines catégories.


```{r Question 8 : Distance correlée absentéisme, fig.align='center', echo=FALSE}

#Etablir les deux datasets avec le nombre d'absences et le temps de trajet
studytime_abs_dataset_mat2 <- student_mat[, c("absences", "studytime")]
studytime_abs_dataset_por2 <- student_por[, c("absences", "studytime")]

# Maths
ggplot(studytime_abs_dataset_mat2, aes(x = factor(studytime))) +
  geom_bar(stat = "count", fill = "lightgreen") +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5) +
  labs(title = "Nombre d'élèves en fonction du temps d'étude chez les élèves de Maths",
       x = "Temps d'étude", y = "Nombre d'élèves") +
  scale_x_discrete(labels=c("1" = "<2 heures", "2" = "2 à 5 heures",
                              "3" = "5 à 10 heures", "4" = ">10 heures")) +
  theme_minimal()


# Portugais
ggplot(studytime_abs_dataset_por2, aes(x = factor(studytime))) +
  geom_bar(stat = "count", fill = "lightgreen") +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.5) +
  labs(title = "Nombre d'élèves en fonction du temps d'étude chez les élèves de Portugais",
       x = "Temps d'étude", y = "Nombre d'élèves") +
  scale_x_discrete(labels=c("1" = "<2 heures", "2" = "2 à 5 heures",
                              "3" = "5 à 10 heures", "4" = ">10 heures")) +
  theme_minimal()
```
Cette fois encore, il y a sensiblement moins d'étudiant dans les catégories 3 et 4, mais il sont suffisamment nombreux pour qu'il reste judicieux de garder toutes les catégories.

Egalement, les étudiants au nombre d'absences extrêmes étant toujours présents, il serait encore une fois intéressant de regarder plutot la médiane des absences pour chaque catégorie plutôt que la moyenne.

Nous réutilisions la même méthodologie que précedemment, et nous allons représenter le nombre d'absences médian en fonction du temps d'étude.

```{r Question 8 : Distance correlée absentéisme, fig.align='center', echo=FALSE}

#En fonction du studytime ?

#Etablir les deux datasets avec le nombre d'absences et le temps de trajet
studytime_abs_dataset_mat3 <- aggregate(absences ~ studytime, data = student_mat, FUN = median)
studytime_abs_dataset_por3 <- aggregate(absences ~ studytime, data = student_por, FUN = median)

#Maths
ggplot(studytime_abs_dataset_mat3, aes(x = studytime, y = absences)) +
  geom_bar(stat = "identity", fill = "lightblue") +
  labs(title = "Nombre median d'absences en fonction du temps d'étude \nchez les élèves de Maths",
       x = "Temps d'étude hebdomadaire", y = "Nombre moyen d'absences") +
  scale_x_continuous(breaks = c(1, 2, 3, 4), labels = c("<2 heures", "2 à 5 heures", "5 à 10 heures", ">10 heures")) +
  theme_minimal()

#Portugais
ggplot(studytime_abs_dataset_por3, aes(x = studytime, y = absences)) +
  geom_bar(stat = "identity", fill = "lightblue") +
  labs(title = "Nombre median d'absences en fonction du temps d'étude \nchez les élèves de Portugais",
       x = "Temps d'étude hebdomadaire", y = "Nombre moyen d'absences") +
  scale_x_continuous(breaks = c(1, 2, 3, 4), labels = c("<2 heures", "2 à 5 heures", "5 à 10 heures", ">10 heures")) +
  theme_minimal()

```
Nous observons aisément, sur la représentation portant sur le dataset des élèves de portugais qu'en effet, plus un élève étudie en dehors des cours, plus il est assidu sur sa présence en classe.

La représentation du dataset de mathématique elle, n'infirme ni ne confirme la tendance.

On peut donc penser plutôt correctement que les élèves qui sont présents souvent en cours, sont sérieux et assidus et travaillent également beaucoup en dehors des cours, et que les élèves qui sont justements absents n'ont pas tendance à beaucoup travailler pour rattraper leur retard.
